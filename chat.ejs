<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="./static/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
        integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
        crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">

    <title>Document</title>
</head>

<style>
    .input_field {
        width: 100%;
        padding: -20px;
        display: flow-root;
    }

    .right {
        color: white;
        background: white;
        border-radius: 16px 20px 0px 20px;
        float: right;
        align-items: flex-end;
        font-size: 14px;
        display: flex;
        width: auto;
        max-width: 100%;
        padding: 10px;
        word-wrap: break-word;
        margin: 0px 0px 10px 200px;
        background-color: #002244;
        flex-direction: column;
        overflow: hidden;
        position: relative;
    }

    input:focus {
        outline: none;
    }
</style>


<body>


    <%- include('../Views/left') %>

        <style>
            .mssg_area {
                scroll-behavior: smooth;
                overflow-y: scroll;

                /* border: 2px solid red; */
            }
        </style>
        <!--  header -->
        <div class="container-fluid mt-5" style="background-color: white;border-radius: 6px;">
            <div class="row">
                <div class="col-lg-6 py-2" style="font-size: 18px;">
                    <i class="fa-sharp fa-solid fa-bars px-3" style="font-size: 18px;"></i>
                    <b>My Open</b>
                </div>
                <div class="col-lg-6 py-2 d-flex justify-content-end" style="color: rgb(21, 130, 202);cursor: pointer;">
                    Enable Notification&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <button class="btn btn-outline-light"
                        style="width: 23%;color: black; font-size: 12px;height: 30px;padding: 0px; border: 1px solid rgb(121, 121, 121);"><i
                            class="fa-sharp fa-solid fa-circle-check px-2"
                            style="font-size: 14px;color: rgb(5, 94, 5);"></i>Mark as Solved</button>
                </div>
            </div>
        </div>
        <!--  header -->


        <!-- ####################  main content ###################### -->
        <div class="container-fluid mt-2" style="background-color: white;border-radius: 6px;overflow: hidden;">
            <div class="row">

                <div class="col-lg-3" style="height: 580px;box-shadow: 0px 0px 3px 0px black;">
                    <div class="row" style="background-color: rgb(230, 230, 230);">
                        <div class="col-lg-2 mt-2"> <i class="fa-sharp fa-solid fa-r px-3"
                                style="font-size: 15px;color:white;background-color: rgb(247, 104, 104); padding: 10px;border-radius: 60%;"></i>
                        </div>
                        <div class="col-lg-9 mt-2" style="font-size: 14px;">
                            <%= result1[0].email %><br>
                                <p style="font-size: 12px;"><b>Live Chat</b></p>
                        </div>
                        <div class="col-lg-10" style="font-size: 12px;">

                            You're Welcome,Please let me Know<br>
                        </div>

                        <div class="row">
                            <div class="col-lg-6 py-2">

                                <button class="btn btn-outline-secondary dropdown-toggle mt-2" type="button"
                                    id="dropdownMenuButton"
                                    style="font-size: 12px;height: 22px;color: black; background-color: rgb(205, 205, 205); padding: 0px;width: 50%;"
                                    data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                                    style="font-size: 13px; width: 130px; height: 32px;">
                                    <%= result1[0].status %>
                                </button>
                                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton" style="width: 20px;">
                                    <a class="dropdown-item" href="#" style="font-size: 14px;">On Hold</a>
                                    <a class="dropdown-item" href="/close_ticket" style="font-size: 14px;">Close</a>
                                    <!-- <a class="dropdown-item" href="#">Something else here</a> -->
                                </div>

                                <!-- <select  style="font-size: 13px; width: 85px; height: 22px; border-radius:5px;padding-bottom: 3px; ">
            <option><%= result1[0].ticket_status %></option>
            <option href="close_ticket">On Hold</option>
            <option>Close</option>
            
        </select> -->

                                <!-- <button class="btn btn-outline-secondary mt-2 "
                                    style="font-size: 12px;height: 22px;color: black; background-color: rgb(205, 205, 205); padding: 0px;width: 50%;">
                                    <%= result1[0].ticket_status %>
                                </button> -->
                            </div>
                            <div class="col-lg-6 d-flex justify-content-end">
                                <i class="fa-sharp fa-solid fa-user "
                                    style="font-size: 16px;padding-top: 17px;padding-left: 100px;"></i>
                            </div>
                        </div>
                    </div>
                </div>


                <!--################## chatbot center ###################3-->
                <div class="col-lg-6 mssg_area" id="msg_area" style="height: 360px;border-bottom: 3px solid #5072A7;">

                    <div class="row mt-2">
                        <div class="col-lg-5" style="border-bottom: 1px solid rgb(187, 187, 187)"></div>
                        <div class="col-lg-2 d-flex justify-content-center" style="font-size: 14px;font-weight: 600;">
                            <%= result1[0].issue_date %>
                        </div>
                        <div class="col-lg-5" style="border-bottom: 1px solid  rgb(187, 187, 187);"></div>
                    </div>


                    <!-- chat 1 -->
                    <% for(i=0;i<resulte.length;i++){ %>
                        <div class="row " style="margin-top: 15px;">
                            <div class="col-lg-1 mt-2"> <i class="fa-sharp fa-solid fa-m px-3"
                                    style="font-size: 14px;color:white;background-color: rgb(247, 104, 104); padding: 10px;border-radius: 50%;"></i>
                            </div>
                            <div class="col-lg-8 mt-2 " style="font-size: 13px;"><b>
                                    <%= result1[0].user_name %>
                                </b>
                                <p style="font-size: 12px; margin-bottom: -0px;"></p>
                                <%= resulte[i].user_res %>
                            </div>


                            <div class="container text-end px-2" style="padding-right: 40px;font-size: 14px;">
                                <b style="padding-right: 13px;">You</b><i class="fa-sharp fa-solid fa-user"
                                    style="font-size: 17px;color:white;color: black; padding: 9px; background-color: rgb(243, 243, 243); border-radius: 50%;"></i>

                            </div>
                            <div class="justify-content-end d-flex "
                                style="font-size: 15px;font-weight: 600;padding: 0px 47px 50px 0px;">
                                <%= resulte[i].bot_res %>
                                    <div class="">
                                    </div>
                            </div>


                        </div>
                        <%}%>
                            <!-- chat 1 -->








                            <!-- chat 2 -->
                            <div class="row mt-2">
                                <!-- <div class="col-lg-1 mt-1"> <i class="fa-sharp fa-solid fa-k px-3"
                                    style="font-size: 15px;color:white;background-color: rgb(247, 104, 104); padding: 10px;border-radius: 50%;"></i>
                            </div>
                            <div class="col-lg-8 mt-1" style="font-size: 12px;padding-left: 18px;">
                                <b>KKmenon@gmail.com</b>&nbsp;&nbsp;&nbsp;&nbsp;11:07 AM<br>
                                <p style="font-size: 11.7px;">Hello !</p>
                            </div> -->
                                <!-- chat 2 -->


                                <!-- chat 3 -->
                                <div class="row mt-1">
                                    <!-- <div class="col-lg-1 mt-1"> <i class="fa-solid fa-user"
                                        style="font-size: 15px;color:white;background-color: rgb(182, 182, 182); padding: 10px;padding-left: 12px; border-radius: 50%;"></i>
                                </div>
                                <div class="col-lg-8 mt-1" style="font-size: 11px;padding-left: 19px;">
                                    <b>YOU</b>&nbsp;&nbsp;&nbsp;&nbsp;11:07 AM<br>
                                    <p style="font-size: 12px;">Huy<br>How can i Help You</p>
                                </div> -->
                                </div>
                                <!-- chat 3 -->

                                <!-- chat 4 -->
                                <div class="row mt-1">
                                    <!-- <div class="col-lg-1 mt-1"> <i class="fa-sharp fa-solid fa-k px-3"
                                        style="font-size: 15px;color:white;background-color: rgb(247, 104, 104); padding: 10px;border-radius: 50%;"></i>
                                </div>
                                <div class="col-lg-8 mt-1" style="font-size: 12px;padding-left: 20px;">
                                    <b>KKmenon@gmail.com</b>&nbsp;&nbsp;&nbsp;&nbsp;11:11 AM<br>
                                    <p style="font-size: 11.7px;">I want some of my work to be displayed here on my
                                        admin
                                        panel?</p>
                                </div> -->
                                </div>
                                <!-- chat 4 -->

                                <!-- chat 5 -->
                                <div class="row mt-1">
                                    <!-- <div class="col-lg-1 mt-1"> <i class="fa-solid fa-user "
                                        style="font-size: 15px;color:white;background-color: rgb(182, 182, 182); padding-left: 19px; padding: 10px;border-radius: 50%;"></i>
                                </div>
                                <div class="col-lg-10 mt-1" style="font-size: 12px;padding-left: 17px;">
                                    <b>YOU</b>&nbsp;&nbsp;&nbsp;&nbsp;11:07 AM<br>
                                    <p style="font-size: 11px;">Ok, We can Setup that but, there will be extra cost for
                                        showcasing the data on your
                                        admin Panel.</p>
                                </div> -->
                                </div>
                                <!-- chat 5 -->
                                <!-- chat 4 -->
                                <div class="row mt-1">
                                    <!-- <div class="col-lg-1 mt-1"> <i class="fa-sharp fa-solid fa-k px-3"
                                        style="font-size: 15px;color:white;background-color: rgb(247, 104, 104); padding: 10px;border-radius: 50%;"></i>
                                </div>
                                <div class="col-lg-8 mt-1" style="font-size: 12px;padding-left: 21px;">
                                    <b>KKmenon@gmail.com</b>&nbsp;&nbsp;&nbsp;&nbsp;11:11 AM<br>
                                    <p style="font-size: 11.7px;">How much will be the cost from here ?</p>
                                </div> -->
                                </div>
                                <!-- chat 4 -->
                            </div>
                </div>
                <!--################## chatbot center ###################3-->







                <div class="col-lg-3"
                    style="box-shadow: 0px 0px 4px 0px black;background-color: rgb(235, 235, 235);overflow-y: scroll; height: 580px;">


                    <div class="container-fluid mt-1 py-2"
                        style="border-bottom:1px solid rgb(101, 101, 101);color: black; cursor: pointer; font-size: 12px;">
                        <div class="row">
                            <div class="col-lg-12"><b style="border-bottom:2px solid rgb(1, 112, 181); "
                                    id="hov">Info</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b id="hov">Viewed
                                    Pages</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>Notes(0)</b></div>
                        </div>
                    </div>

                    <!-- chabot user information -->

                    <div class="container-fluid py-1 mt-2"
                        style="background-color: white;border-radius: 4px;color: rgb(51, 51, 51);">
                        <div class="col-lg-12 mt-2 py-1 d-flex" style="font-size: 12.3px;"><i
                                class="fa-sharp fa-solid fa-user-tie px-3"
                                style="font-size: 15px;color: rgb(99, 99, 99);"></i><b>
                                <%= result1[0].user_name %>
                            </b>
                        </div>
                        <div class="col-lg-12 mt-2  py-1" style="font-size: 12.3px;"><i
                                class="fa-sharp fa-solid fa-location-dot px-3"
                                style="font-size: 14px;color: rgb(99, 99, 99);"></i>Delhi, India
                        </div>
                        <div class="col-lg-12 mt-2 py-1 d-flex" style="font-size: 12.3px;"><i
                                class="fa-sharp fa-solid fa-solid fa-envelopes-bulk px-3"
                                style="font-size: 14px;color: rgb(99, 99, 99);"></i><b>
                                <%= result1[0].email %>
                            </b><br>

                        </div>
                        <div class="col-lg-12 mt-2  py-1" style="font-size: 12.3px;"><i class="fa-solid fa-ticket px-3"
                                style="font-size: 14px;color: rgb(99, 99, 99);"></i>
                            #<%= result1[0].ticket_no %>
                        </div>
                        <div class="col-lg-12 mt-2  py-1" style="font-size: 12.3px;"><i
                                class="fa-sharp fa-solid fa-laptop px-3"
                                style="font-size: 14px;color: rgb(99, 99, 99);"></i>Chrome 109, Windows
                        </div>
                        <div class="col-lg-12 mt-2 d-flex py-1" style="font-size: 12.3px;"><i
                                class="fa-sharp  fa-solid fa-location-crosshairs px-3"
                                style="font-size: 15px;color: rgb(99, 99, 99);"></i>
                            <%= result1[0].ip_address %>
                        </div>
                        <div class="col-lg-12 mt-2  py-1" style="font-size: 12.3px;"><i
                                class="fa-sharp  fa-solid fa-tag px-3"
                                style="font-size: 15px;color: rgb(99, 99, 99);"></i>Add a Tag</div>
                        <div class="col-lg-12 mt-2  py-1" style="font-size: 12.3px;"><i
                                class="fa-sharp  fa-solid fa-file px-3"
                                style="font-size: 15px;color: rgb(99, 99, 99);"></i>Add a Contact
                            Property...</div>
                    </div>
                    <!-- chabot user information -->

                    <div class="container-fluid mt-2 py-2"
                        style="background-color: white;border-radius: 6px;font-size: 12px;">
                        <div class="col-lg-12"><i class="fa-sharp fa-solid fa-user px-2" style="font-size: 16px;"></i>

                            <button class=" dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"
                                style="border: none;background-color: white;">
                                Assign-ticket
                            </button>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#">ravi@gmail.com</a></li>
                                <li><a class="dropdown-item" href="#">yoginder@gmail.com</a></li>
                                <li><a class="dropdown-item" href="#">amit@gmail.com</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="container-fluid mt-2 py-2" style="background-color: white;border-radius: 5px;">
                        <div class="row">
                            <div class="col-lg-12" style="font-size: 13.7px;"><i
                                    class="fa-sharp fa-solid fa-ticket px-2"
                                    style="color: rgb(99, 99, 99);"></i><b>Ticket History</b></div>

                        </div>
                        <div class="row mt-2">
                            <div class="col-lg-12" style="font-size: 12px;"><i
                                    class="fa-sharp fa-solid fa-arrow-up-right-from-square px-3"></i>
                                Cost for Data show
                            </div>
                            <div class="col-lg-12 mt-2" style="font-size: 12px;"><i
                                    class="fa-sharp fa-solid fa-arrow-up-right-from-square px-3"></i>Support Team
                                Details
                            </div>
                        </div>
                    </div>
                    <div class="container-fluid mt-2 py-2" style="background-color: white;border-radius: 6px;">
                        <div class="col-lg-12 py-2"
                            style="font-size: 12px; border-bottom: 1px solid rgb(174, 174, 174);">
                            <i class="fa-sharp fa-solid fa-tv px-2" style="font-size: 17px;"></i>Latest Viewed page
                        </div>
                        <div class="col-lg-12 py-2 mt-2"
                            style="font-size: 12px;border-bottom: 1px solid rgb(110, 110, 110);">
                            <i class="fa-sharp fa-solid fa-user-tag fa-tv px-2"
                                style="font-size: 12px;color: rgb(129, 129, 129);"></i>/ChatbotPanel

                        </div>
                        <div class="row">

                            <div class="col-lg-8  mt-3" style="font-size: 13px;">
                                <i class="fa-sharp fa-solid fa-clock-rotate-left px-2"
                                    style="font-size: 12px;"></i><b>See
                                    the History</b>
                            </div>
                            <div class="col-lg-4  d-flex justify-content-end">

                            </div>
                        </div>
                    </div>

                    <div class="container-fluid mt-2"
                        style="background-color: white;border-radius: 5px;margin-bottom: 20px;">
                        <div class="col-lg-12  py-2" style="font-size: 12.7px;"><i
                                class="fa-sharp fa-solid fa-face-smile px-3" style="font-size: 17px;">
                            </i> Visitor has not Rated Yet
                        </div>
                    </div>
                </div>

                <!-- </div> -->





                <div class="container-fluid py-2" id="chat"
                    style="position: fixed;width: 600px;top: 425px;left: 410px;">
                    <div class="row">
                        <div class="col-lg-12 py-2" style=" font-size: 14px;position: relative;top: 34px;"><i
                                class="fa-sharp fa-solid fa-comment px-2" style="
                        font-size: 16px;"></i>chat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            <i class="fa-sharp fa-solid fa-envelope px-2"
                                style="font-size: 16px;color: rgb(3, 100, 164);"></i>E-mail
                        </div>


                        <input type="text" id="text" class="border-0" placeholder="Write your Message "
                            style="height: 110px;width: 775px; font-size: 14px;padding-top: 0px; border: 1px solid rgb(99, 99, 99); background-color: white;">


                        <button class="btn btn-dark" id="send"
                            style="position: fixed;bottom: 150px;left: 890px;width: 7%;padding: 0px;font-size: 13px;height: 30px;">Send</button>

                        <div class="col-lg-2" id="btn">
                            <!-- <div class=" rounded-5"
                                    style="padding: 0px;position: absolute; top: 70px;background-color: #737373; left: 520px; padding: 14px;">
                                    <i class="fa-solid fa-paper-plane" style="font-size: 20px;color: white;"></i>
                                </div> -->
                        </div>

                        <div class="container">
                            <div class="row">
                                <div class="col-lg-6 py-2">
                                    <!-- Button trigger modal -->

                                    <i class="fa-solid fa-link mt-5" data-bs-toggle="modal"
                                        data-bs-target="#exampleModal" style="font-size: 20px;"></i>


                                    <!-- Modal -->
                                    <div class="modal fade" id="exampleModal" tabindex="-1"
                                        aria-labelledby="exampleModalLabel" aria-hidden="true">
                                        <div class="modal-dialog">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title
                                                    </h1>
                                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                        aria-label="Close"></button>
                                                </div>
                                                <div class="modal-body">
                                                    ...
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary"
                                                        data-bs-dismiss="modal">Close</button>
                                                    <button type="button" class="btn btn-primary">Save
                                                        changes</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                                <div class="col-lg-5 py-2 d-flex justify-content-end mt-5" style=" cursor: pointer;">
                                    <i class="fa-sharp fa-solid fa-bold px-2" style="font-size: 16px;" id="bold"></i>
                                    <i class="fa-solid fa-italic px-5" style="font-size: 16px;"></i><i
                                        class="fa-solid fa-underline px-2" style="font-size: 17px;"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- </div> -->

                    <!-- <script>
                            $("#bold").click(function () {
                                $("#input").addClass("blue");
                                //   $("#input").hide();
                            });

                        </script> -->
                    <!-- <script>
                            $.ajax({

                                type: "GET",
                                dataType: "JSON",
                                url: `/ticketing`,
                                success: function (data) {
                                    // for (i = 0; i < data.result.length; i++) {
                                    $('#name').append(data.result[0].name);
                                                                        $('#ticket').append(data.result[0].ticket_num);

                                    $('#ip').append(data.result[0].ip_address);
                                    $('#mail').append(data.result[0].email);
                                }
                                // }
                            });
                        </script> -->

                    <script>
                        document.addEventListener("DOMContentLoaded", function (event) {

                            const showNavbar = (toggleId, navId, bodyId, headerId) => {
                                const toggle = document.getElementById(toggleId),
                                    nav = document.getElementById(navId),
                                    bodypd = document.getElementById(bodyId),
                                    headerpd = document.getElementById(headerId)

                                // Validate that all variables exist
                                if (toggle && nav && bodypd && headerpd) {
                                    toggle.addEventListener('click', () => {
                                        // show navbar
                                        nav.classList.toggle('show')
                                        // change icon
                                        toggle.classList.toggle('bx-x')
                                        // add padding to body
                                        bodypd.classList.toggle('body-pd')
                                        // add padding to header
                                        headerpd.classList.toggle('body-pd')
                                    })
                                }
                            }

                            showNavbar('header-toggle', 'nav-bar', 'body-pd', 'header')

                            /*===== LINK ACTIVE =====*/
                            const linkColor = document.querySelectorAll('.nav_link')

                            function colorLink() {
                                if (linkColor) {
                                    linkColor.forEach(l => l.classList.remove('active'))
                                    this.classList.add('active')
                                }
                            }
                            linkColor.forEach(l => l.addEventListener('click', colorLink))

                            // Your code to run since DOM is loaded and ready
                        });


                    </script>


                    <script>
                        $("#input").click(function () {
                            $("#input").css("border", "2px solid whi");
                        });
                    </script>

                    <script>
                        document.getElementById('send').addEventListener("click", async (e) => {
                            e.preventDefault();
                            var req = document.getElementById('text').value;
                            if (req == undefined || req == "") {
                            }
                            else {
                                var res_msg01 = document.createElement('div');
                                res_msg01.setAttribute("class", "input_field");
                                document.getElementById('msg_area').appendChild(res_msg01);

                                var res_msg = document.createElement('div');
                                res_msg.innerHTML = req;
                                res_msg.setAttribute("class", "right");
                                res_msg.setAttribute("id", "response");
                                // document.getElementById('text').value = "";
                                res_msg01.appendChild(res_msg);
                                // document.getElementById('msg_area').appendChild(res_msg);
                                var d = document.getElementById("msg_area");
                                // console.log(d, d.scrollHeight)
                                setTimeout(() => {
                                    $(window).scrollTop($(window).height());
                                    window.scrollTo(0, d.scrollHeight);
                                    // window.scrollBy(0, d.scrollHeight);

                                }, 100);

                            }
                        });
                    </script>

                    <script>
                        $(document).ready(function () {
                            $(document).on('click', '.mssg_area', function () {
                                var d = document.getElementById("#msg_area");
                                console.log(d, d.scrollHeight)
                                setTimeout(() => {
                                    $(window).scrollTop($(window).height());
                                    window.scrollTo(0, d.scrollHeight);
                                    window.scrollBy(0, d.scrollHeight);
                                }, 30);

                            });
                        })
                        function backToMenu() {
                            window.scrollTo(0, 0);
                        }
                    </script>
                    <script>
                        const textbox = document.getElementById("text");
                        textbox.addEventListener("keypress", function onEvent(event) {
                            if (event.key === "Enter") {
                                document.getElementById("send").click();
                            }
                        });
                    </script>

                    <script>
                        $(document).on('click', '#send', function () {
                            var bot_res = $('#text').val();
                            document.getElementById('text').value = "";
                            console.log(bot_res)
                            // alert('done')
                            $.ajax({
                                url: '/chat_print',
                                method: 'post',
                                data: { bot_res: bot_res },
                                success: function (result) {

                                }
                            })
                        })
                    </script>

                    <script>
                        $(document).on('click', '#send', function () {
                            var bot_res = $('#text').val();
                            document.getElementById('text').value = "";
                            console.log(bot_res)
                            // alert('done')
                            $.ajax({
                                url: '/chat',
                                method: 'post',
                                data: { bot_res: bot_res },
                                success: function (result) {

                                }
                            })
                        })
                    </script>



</body>

</html>